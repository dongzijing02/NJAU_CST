import plotly.graph_objects as go
import base64
import io

# Draw the picture using Plotly
fig = go.Figure(
    data=[go.Bar(y=[2, 1, 3])]
)

# Create an in-memory binary stream
image_stream = io.BytesIO()

# Write the image data to the stream
fig.write_image(image_stream, format='png')

# Seek back to the beginning of the stream
image_stream.seek(0)

# Read the image data from the stream and encode it to base64
encoded_string = base64.b64encode(image_stream.read()).decode()

# Return the base64 string
print(encoded_string)


import plotly.graph_objects as go
from collections import defaultdict

data_list = [  
      {'area': '东北', 'cname': '大钰贸易', 'total_num': 45},
    {'area': '西南', 'cname': '东南实业', 'total_num': 33}
]

# Group data by 'cname'
grouped_data = defaultdict(list)
for item in data_list:
    grouped_data[item['cname']].append((item['area'], item['total_num']))

fig = go.Figure()

# Create a line for each 'cname'
for cname, values in grouped_data.items():
    areas, total_nums = zip(*values)
    fig.add_trace(go.Scatter(x=areas, y=total_nums, mode='lines+markers', name=cname))

fig.show()